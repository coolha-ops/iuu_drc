<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EM 데이터 영상 리스트 - 원양어선 EM 플랫폼</title>
    <link rel="stylesheet" href="styles_3.css">
    <link rel="stylesheet" href="data_list.css">
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="header-title-wrapper">
            <img src="image/Emblem_of_the_Government_of_the_Republic_of_Korea.svg.png" alt="대한민국 정부 상징" class="header-logo">
            <div class="header-text-wrapper">
                <div class="header-subtitle">Data Review Center</div>
                <h1 class="header-title">원양어선 EM 데이터 플랫폼</h1>
            </div>
        </div>
        <div class="button-wrapper">
            <button>AI 모델 운영</button>
            <button class="active">옵서버 Review</button>
            <button>장비 관리</button>
            <button>조업 정보</button>
            <button>선박 모니터링</button>
        </div>
    </header>

    <!-- 메인 컨텐츠 -->
    <div class="data-list-main-container">
        <!-- 검색 및 필터 영역 (20%) -->
        <div class="search-filter-section">
            <div class="search-filter-box">
                <div class="search-guide-text">데이터는 조업 유형, RFMO 수역, 선박 활동 등 다양한 기준으로 분류됩니다.<br>분석 목적에 맞는 조건을 선택해 탐색을 시작하세요.</div>
                <div class="search-filter-row">
                    <!-- 검색어 -->
                    <div class="filter-item">
                        <input type="text" class="filter-input" id="search-input" placeholder="검색어 입력">
                    </div>
                    <!-- 필터 버튼 -->
                    <div class="filter-item filter-button-item">
                        <button class="filter-modal-button" id="filter-button">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                            </svg>
                            필터
                        </button>
                    </div>
                    <!-- 검색 버튼 -->
                    <div class="filter-item filter-button-item">
                        <button class="search-filter-button" id="search-button">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            검색
                        </button>
                    </div>
                </div>
                <!-- 선택된 필터 태그 영역 -->
                <div class="selected-filters-container" id="selected-filters-container" style="display: none;">
                    <div class="selected-filters-label">선택된 필터:</div>
                    <div class="selected-filters-tags" id="selected-filters-tags"></div>
                </div>
            </div>
        </div>

        <!-- 카드 그리드 영역 (70%) -->
        <div class="card-grid-section">
            <!-- 날짜별 섹션 -->
            <div class="card-section">
                <div class="section-header">
                    <h2 class="section-title">날짜별</h2>
                    <a href="#" class="more-link">></a>
                </div>
                <div class="card-grid">
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/verified_CAM1_20230725054246_120_1.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">2023.07.21</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 동원 121</div>
                                <div class="card-date">Last uploaded 20 days ago</div>
                            </div>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/verified_CAM1_20230725082746_100_1.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">2023.07.22</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 사조 211</div>
                                <div class="card-date">Last uploaded 19 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 선사별 섹션 -->
            <div class="card-section">
                <div class="section-header">
                    <h2 class="section-title">선사별</h2>
                    <a href="#" class="more-link">></a>
                </div>
                <div class="card-grid">
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/35d7760c-20230801045326_sam.jpg" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">동원산업</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 사조 134</div>
                                <div class="card-date">Last uploaded 15 days ago</div>
                            </div>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/ed1bee1b-20230801045433_sam.jpg" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">사조산업</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 동원 121</div>
                                <div class="card-date">Last uploaded 14 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 선박별 섹션 -->
            <div class="card-section">
                <div class="section-header">
                    <h2 class="section-title">선박별</h2>
                    <a href="#" class="more-link">></a>
                </div>
                <div class="card-grid">
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/f57780a5-20230801044924_sam.jpg" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">동원 101</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 사조 134</div>
                                <div class="card-date">Last uploaded 15 days ago</div>
                            </div>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/full_pipeline_CAM1_20230808045243_90_1.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">사조 223</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 동원 121</div>
                                <div class="card-date">Last uploaded 14 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 조업별 섹션 -->
            <div class="card-section">
                <div class="section-header">
                    <h2 class="section-title">조업별</h2>
                    <a href="#" class="more-link">></a>
                </div>
                <div class="card-grid">
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/full_pipeline_CAM1_20230808111742_120_2.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">연승</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 동원 134</div>
                                <div class="card-date">Last uploaded 10 days ago</div>
                            </div>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/verified_CAM1_20230729071131_140_1.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">운반선</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 사조 121</div>
                                <div class="card-date">Last uploaded 9 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 수역별 섹션 -->
            <div class="card-section">
                <div class="section-header">
                    <h2 class="section-title">수역별</h2>
                    <a href="#" class="more-link">></a>
                </div>
                <div class="card-grid">
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/verified_CAM1_20230729071131_140_2.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">ICCAT</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 동원 121</div>
                                <div class="card-date">Last uploaded 20 days ago</div>
                            </div>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/verified_CAM1_20230729071131_140_3.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">WCPFC</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 사조 211</div>
                                <div class="card-date">Last uploaded 19 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 어종별 섹션 -->
            <div class="card-section">
                <div class="section-header">
                    <h2 class="section-title">어종별</h2>
                    <a href="#" class="more-link">></a>
                </div>
                <div class="card-grid">
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/Generated Image November 17, 2025 - 3_14PM.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">어획종</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 동원 134</div>
                                <div class="card-date">Last uploaded 10 days ago</div>
                            </div>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-image-wrapper">
                            <img src="image/Generated Image November 17, 2025 - 3_15PM.png" alt="영상 썸네일" class="card-image">
                            <div class="card-menu">
                                <span class="card-menu-dots">⋯</span>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="card-filename">부수어획종</div>
                            <div class="card-meta">
                                <div class="card-creator">Recorded by 사조 121</div>
                                <div class="card-date">Last uploaded 9 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 필터 모달 -->
    <div class="filter-modal-overlay" id="filter-modal-overlay">
        <div class="filter-modal">
            <div class="filter-modal-header">
                <h3 class="filter-modal-title">필터</h3>
                <button class="filter-modal-close" id="filter-modal-close">×</button>
            </div>
            <div class="filter-modal-content">
                <!-- 날짜 범위 -->
                <div class="filter-category">
                    <h4 class="filter-category-title">날짜 범위</h4>
                    <div class="filter-date-range">
                        <div class="filter-date-item">
                            <label class="filter-date-label">시작일</label>
                            <input type="date" class="filter-date-input" id="modal-date-start">
                        </div>
                        <div class="filter-date-item">
                            <label class="filter-date-label">종료일</label>
                            <input type="date" class="filter-date-input" id="modal-date-end">
                        </div>
                        <div class="filter-date-error" id="date-error" style="display: none; color: #ef4444; font-size: 13px; margin-top: 8px;">
                            시작일은 종료일보다 이전이어야 합니다.
                        </div>
                    </div>
                </div>

                <!-- 선사 -->
                <div class="filter-category">
                    <h4 class="filter-category-title">선사</h4>
                    <div class="filter-checkbox-group" id="company-group">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="company" value="동원">
                            <span>동원</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="company" value="사조">
                            <span>사조</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="company" value="신라">
                            <span>신라</span>
                        </label>
                    </div>
                </div>

                <!-- 선박명 -->
                <div class="filter-category" id="vessel-category" style="display: none;">
                    <h4 class="filter-category-title">선박명</h4>
                    <div class="filter-checkbox-group" id="vessel-group"></div>
                </div>

                <!-- 조업 유형 -->
                <div class="filter-category">
                    <h4 class="filter-category-title">조업 유형</h4>
                    <div class="filter-checkbox-group" id="operation-group">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="operation" value="연승">
                            <span>연승</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="operation" value="운반선">
                            <span>운반선</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="operation" value="선망">
                            <span>선망</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="operation" value="저연승">
                            <span>저연승</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="operation" value="채낚기">
                            <span>채낚기</span>
                        </label>
                    </div>
                </div>

                <!-- 기타 -->
                <div class="filter-category">
                    <h4 class="filter-category-title">기타</h4>
                    <div class="filter-checkbox-group" id="other-group">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="오탐">
                            <span>오탐</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="미탐">
                            <span>미탐</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="낮은 Confidence">
                            <span>낮은 Confidence</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="클래스 오분류">
                            <span>클래스 오분류</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="Box 위치 오류">
                            <span>Box 위치 오류</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="중복 검출">
                            <span>중복 검출</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="filter-checkbox" data-filter="other" value="클래스 편향">
                            <span>클래스 편향</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="filter-modal-footer">
                <button class="filter-reset-button" id="filter-reset-button">초기화</button>
            </div>
        </div>
    </div>

    <script>
        // 선박명 데이터
        const vesselData = {
            '동원': ['동원 101', '동원 121', '동원 134', '동원 161', '동원 201', '동원 205', '동원 189'],
            '사조': ['사조 111', '사조 211', '사조 301', '사조 305', '사조 189', '사조 203'],
            '신라': ['신라 101', '신라 201', '신라 301', '신라 405', '신라 189', '신라 203', '신라 250']
        };

        // 필터 상태
        let selectedFilters = {
            dateStart: '',
            dateEnd: '',
            company: [],
            vessel: [],
            operation: [],
            other: []
        };

        // DOM 요소
        const filterButton = document.getElementById('filter-button');
        const filterModalOverlay = document.getElementById('filter-modal-overlay');
        const filterModalClose = document.getElementById('filter-modal-close');
        const filterResetButton = document.getElementById('filter-reset-button');
        const vesselCategory = document.getElementById('vessel-category');
        const vesselGroup = document.getElementById('vessel-group');
        const selectedFiltersContainer = document.getElementById('selected-filters-container');
        const selectedFiltersTags = document.getElementById('selected-filters-tags');
        const searchButton = document.getElementById('search-button');
        const modalDateStart = document.getElementById('modal-date-start');
        const modalDateEnd = document.getElementById('modal-date-end');
        const dateError = document.getElementById('date-error');

        // 필터 모달 열기
        filterButton.addEventListener('click', () => {
            filterModalOverlay.style.display = 'flex';
        });

        // 필터 모달 닫기
        filterModalClose.addEventListener('click', () => {
            filterModalOverlay.style.display = 'none';
        });

        // 배경 클릭으로 모달 닫기
        filterModalOverlay.addEventListener('click', (e) => {
            if (e.target === filterModalOverlay) {
                filterModalOverlay.style.display = 'none';
            }
        });

        // 선사 체크박스 변경 시 선박명 동적 표시
        document.querySelectorAll('#company-group .filter-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const company = e.target.value;
                const isChecked = e.target.checked;

                if (isChecked) {
                    if (!selectedFilters.company.includes(company)) {
                        selectedFilters.company.push(company);
                    }
                } else {
                    selectedFilters.company = selectedFilters.company.filter(c => c !== company);
                    // 해당 선사의 선박명 선택 해제
                    selectedFilters.vessel = selectedFilters.vessel.filter(v => {
                        return !v.startsWith(company);
                    });
                }

                updateVesselOptions();
                updateSelectedFiltersDisplay();
            });
        });

        // 선박명 옵션 업데이트
        function updateVesselOptions() {
            vesselGroup.innerHTML = '';

            if (selectedFilters.company.length === 0) {
                vesselCategory.style.display = 'none';
                return;
            }

            vesselCategory.style.display = 'block';
            const vessels = new Set();

            selectedFilters.company.forEach(company => {
                if (vesselData[company]) {
                    vesselData[company].forEach(vessel => {
                        vessels.add(vessel);
                    });
                }
            });

            vessels.forEach(vessel => {
                const label = document.createElement('label');
                label.className = 'filter-checkbox-label';
                label.innerHTML = `
                    <input type="checkbox" class="filter-checkbox" data-filter="vessel" value="${vessel}" ${selectedFilters.vessel.includes(vessel) ? 'checked' : ''}>
                    <span>${vessel}</span>
                `;
                vesselGroup.appendChild(label);
            });

            // 선박명 체크박스 이벤트 리스너 추가
            vesselGroup.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const vessel = e.target.value;
                    if (e.target.checked) {
                        if (!selectedFilters.vessel.includes(vessel)) {
                            selectedFilters.vessel.push(vessel);
                        }
                    } else {
                        selectedFilters.vessel = selectedFilters.vessel.filter(v => v !== vessel);
                    }
                    updateSelectedFiltersDisplay();
                });
            });
        }

        // 날짜 필드 이벤트
        modalDateStart.addEventListener('change', () => {
            selectedFilters.dateStart = modalDateStart.value;
            validateDateRange();
            updateSelectedFiltersDisplay();
        });

        modalDateEnd.addEventListener('change', () => {
            selectedFilters.dateEnd = modalDateEnd.value;
            validateDateRange();
            updateSelectedFiltersDisplay();
        });

        // 날짜 유효성 검사
        function validateDateRange() {
            if (selectedFilters.dateStart && selectedFilters.dateEnd) {
                if (selectedFilters.dateStart > selectedFilters.dateEnd) {
                    dateError.style.display = 'block';
                    return false;
                } else {
                    dateError.style.display = 'none';
                    return true;
                }
            }
            dateError.style.display = 'none';
            return true;
        }


        // 조업 유형 및 기타 체크박스 이벤트
        document.querySelectorAll('#operation-group .filter-checkbox, #other-group .filter-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const filterType = e.target.getAttribute('data-filter');
                const value = e.target.value;

                if (e.target.checked) {
                    if (!selectedFilters[filterType].includes(value)) {
                        selectedFilters[filterType].push(value);
                    }
                } else {
                    selectedFilters[filterType] = selectedFilters[filterType].filter(v => v !== value);
                }
                updateSelectedFiltersDisplay();
            });
        });

        // 선택된 필터 표시 업데이트
        function updateSelectedFiltersDisplay() {
            const allFilters = [];

            // 날짜 필터 추가
            if (selectedFilters.dateStart && selectedFilters.dateEnd) {
                if (selectedFilters.dateStart === selectedFilters.dateEnd) {
                    allFilters.push({ type: 'date', value: selectedFilters.dateStart, label: `날짜: ${selectedFilters.dateStart}` });
                } else {
                    allFilters.push({ type: 'date', value: `${selectedFilters.dateStart}_${selectedFilters.dateEnd}`, label: `날짜: ${selectedFilters.dateStart} ~ ${selectedFilters.dateEnd}` });
                }
            }

            allFilters.push(
                ...selectedFilters.company.map(c => ({ type: 'company', value: c, label: c })),
                ...selectedFilters.vessel.map(v => ({ type: 'vessel', value: v, label: v })),
                ...selectedFilters.operation.map(o => ({ type: 'operation', value: o, label: o })),
                ...selectedFilters.other.map(o => ({ type: 'other', value: o, label: o }))
            );

            if (allFilters.length === 0) {
                selectedFiltersContainer.style.display = 'none';
                return;
            }

            selectedFiltersContainer.style.display = 'flex';
            selectedFiltersTags.innerHTML = '';

            // 검색어 입력창의 너비 가져오기
            const searchInput = document.getElementById('search-input');
            const searchInputContainer = searchInput.closest('.filter-item');
            const searchInputWidth = searchInputContainer.offsetWidth;
            
            // 선택된 필터 컨테이너의 너비를 검색어 입력창과 동일하게 설정
            selectedFiltersContainer.style.maxWidth = searchInputWidth + 'px';
            
            const labelWidth = selectedFiltersContainer.querySelector('.selected-filters-label').offsetWidth;
            const gap = 12; // gap 크기
            const availableWidth = searchInputWidth - labelWidth - gap;

            let currentWidth = 0;
            let visibleCount = 0;
            let shouldShowEllipsis = false;

            // 태그들을 추가하면서 너비 체크
            for (let i = 0; i < allFilters.length; i++) {
                const filter = allFilters[i];
                const tag = document.createElement('span');
                tag.className = 'selected-filter-tag';
                tag.innerHTML = `${filter.label} <span class="tag-close" data-type="${filter.type}" data-value="${filter.value}">×</span>`;
                
                // 임시로 추가해서 너비 측정
                selectedFiltersTags.appendChild(tag);
                const tagWidth = tag.offsetWidth;
                
                // 너비를 넘으면 이전 태그 제거하고 말줄임표 표시
                if (currentWidth + tagWidth > availableWidth && visibleCount > 0) {
                    tag.remove();
                    shouldShowEllipsis = true;
                    break; // 나머지 필터는 표시하지 않음
                }
                
                currentWidth += tagWidth + 8; // gap 포함
                visibleCount++;
            }

            // 말줄임표 태그 추가
            if (shouldShowEllipsis) {
                const ellipsisTag = document.createElement('span');
                ellipsisTag.className = 'selected-filter-tag ellipsis-tag';
                ellipsisTag.textContent = '...';
                selectedFiltersTags.appendChild(ellipsisTag);
            }

            // 태그 닫기 버튼 이벤트
            document.querySelectorAll('.tag-close').forEach(closeBtn => {
                closeBtn.addEventListener('click', (e) => {
                    const type = e.target.getAttribute('data-type');
                    const value = e.target.getAttribute('data-value');

                    if (type === 'date') {
                        // 날짜 필터 제거
                        selectedFilters.dateStart = '';
                        selectedFilters.dateEnd = '';
                        modalDateStart.value = '';
                        modalDateEnd.value = '';
                        dateError.style.display = 'none';
                    } else {
                        // 체크박스 해제
                        document.querySelectorAll(`.filter-checkbox[data-filter="${type}"][value="${value}"]`).forEach(cb => {
                            cb.checked = false;
                        });

                        // 필터 상태에서 제거
                        selectedFilters[type] = selectedFilters[type].filter(v => v !== value);

                        // 선사가 해제되면 해당 선박명도 제거
                        if (type === 'company') {
                            selectedFilters.vessel = selectedFilters.vessel.filter(v => !v.startsWith(value));
                            updateVesselOptions();
                        }
                    }

                    updateSelectedFiltersDisplay();
                });
            });
        }

        // 초기화 버튼
        filterResetButton.addEventListener('click', () => {
            selectedFilters = {
                dateStart: '',
                dateEnd: '',
                company: [],
                vessel: [],
                operation: [],
                other: []
            };

            document.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });

            modalDateStart.value = '';
            modalDateEnd.value = '';
            dateError.style.display = 'none';

            vesselCategory.style.display = 'none';
            updateSelectedFiltersDisplay();
        });

        // 검색 버튼
        searchButton.addEventListener('click', () => {
            const searchText = document.getElementById('search-input').value;
            
            // 날짜 유효성 검사
            if (!validateDateRange()) {
                alert('시작일은 종료일보다 이전이어야 합니다.');
                return;
            }
            
            console.log('검색 실행:', {
                searchText,
                dateRange: {
                    start: selectedFilters.dateStart,
                    end: selectedFilters.dateEnd
                },
                filters: selectedFilters
            });
            
            // 여기에 실제 검색 로직 구현
            // alert('검색이 실행되었습니다.');
        });
    </script>
</body>
</html>

